<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700" rel="stylesheet">
    <title>Création d'une Extension WordPress Step by Step</title>
  <link href="css/app.css" rel="stylesheet"></head>
  <body>
    <noscript>
      <strong>We're sorry but this page doesn't work properly without JavaScript enabled. Please enable it to continue.</strong>
    </noscript>
    <div id="app"></div>
    <div id="fulllist">
      <!-- step 0 -->
      <div>
          <p>Crée une instance WordPress en local</p>
      </div>

      <!-- step 1 -->
      <div>
        <p>Dans le dossier où WordPress installe ses extensions, ajoute un nouveau dossier <code>partenariat-simplon</code></p>
        <div></div>
        <div class="more">
          WordPress installe des plugins dans <code>wp-content/plugins/</code>
        </div>
      </div>

      <!-- step 2 -->
      <div>
        <p>Dans le dossier partenariat-simplon crée un nouveau fichier, appele-le <code>partenariat-simplon.php</code></p>
        <p>Il n'est pas obligatoire que le fichier soit nommé comme le dossier, mais c'est une convention très souvent respectée.</p>
      </div>

      <!-- step 3 -->
      <div>
        <p>Dans cette étape tu vas faire ce qu'on l'appele <em>déclarer le plugin.</em> </p>
        <p>Il s'agit de renseigner le nom de ton plugin (obligatoire) ainsi que d'autre informations le concernant (auteur, version, descriptions, etc.) Suite à cela tu devrais l'appercevoir dans ton tableau de bord Extensions Installées. Tu peux trouver plus d'information par exemple dans <a href="https://openclassrooms.com/fr/courses/1891206-propulsez-votre-site-avec-wordpress/1892319-creer-des-plugins#r-1892278" target="_blank">un tuto sur OpenClassrooms</a></p>
        <div class="astuce">
          La version minimum de la déclaration d'un plugin est comme ceci :
          <code>
<pre>
&lt;?php
/*
Plugin Name: Partenariat Simplon
*/
</pre>    </code>
        </div>
      </div>

      <!-- step 4 -->
      <div>
        <p>Vérifie que ton plugin est bien présent dans Extensions &gt; Extensions Installées</p>
      </div>
    
      <!-- step 5 -->
      <div>
        <p>Rends ton plugin fonctionnel.</p>
        <p>Ici, tu devrais ajouter un nouveau shortcode et définir ce qu'il affiche.</p>
        <p><a href="https://karac.ch/blog/creer-ses-propres-shortcodes-wordpress" target="_blank">exemple</a></p>
        <div class="astuce">
          <p>Voici l'exemple d'un shortcode qui permet d'afficher un paragraphe
          <quote>Hello World! I &hearts; you!</quote>
          avec un shortcode <code>[helloworld]</code>.</p>
          <code>
<pre>
function HelloWorldShortcode() {
    return '&lt;p&gt;Hello World! I &amp;hearts; you!&lt;/p&gt;';
}
add_shortcode('helloworld', 'HelloWorldShortcode');
</pre>
          </code>
      </div>
    </div>

    <!-- step 6 -->
    <div>
      <p>Vérifie que ton plugin fonctionne. Ajoute le shortcode <code>[partenariat-simplon]</code> dans un plusieurs articles.</p>
      <p>Si cela fonctionne, bravo ! Tu viens de créer un extension WordPress. Si tu as envie de continuer, allons-y !</p>
    </div>

    <!-- step 7 -->
    <div>
      <p>Emballe ta fonction avec une condition <code>if ( ! function_exists( '..' )</code></p>
      <p>C'est un ajustement qui te protégera contre la situation où le thème, ou un autre plugin déclare une fonction qui s'appelle exactement comme la tienne. Avec PHP ceci aurait fini en page blanche, erreur fatale, panique totale.</p>
      <div class="astuce">
        <p>Voici à quoi devrait ressembler ton code :</p>
          <code>
<pre>
if ( ! function_exists( 'HelloWorldShortcode' ) ) {
  function HelloWorldShortcode() {
    return '&lt;p&gt;Hello World! I &amp;hearts; you!&lt;/p&gt;';
  }
}
add_shortcode('helloworld', 'HelloWorldShortcode');
</pre>
          </code>
      </div>
    </div>
    <div>
      <p>Ajoute une mise en page et un logo de simplon.</p>
      <p>Dans le dossier de ton extension crée le ficher <code>style.css.</code> Ensuite ajoute un dossier <code>images.</code> Mets le logo de simplon dans le dossier images.</p>
    </div>
    <div>
      <p>Charge le fichier style.css dans la partie head de la page</p>
      <code>
<pre>
function simplon_partenariat_style() {
  wp_enqueue_style( 'simplon-partenariat', plugins_url( 'partenariat-simplon/style.css' ) );
}
add_action( 'wp_enqueue_scripts', 'simplon_partenariat_style' );
</pre>
      </code>
    <p><code>plugins_url( 'partenariat-simplon/style.css' )</code><br> correspond à <br><code>http(s)://mon-adresse-du-site/wp-content/plugins/partenariat-simplon/style.css</code></p>
    </div>
    <div>
      <p>Ajoute une image</p>
      <p >Quelle est l'adresse to ton image ?</p>
      <p class="astuce"><code>plugins_url( 'partenariat-simplon/images/logo.png' )</code><br> correspond à <br><code>http(s)://mon-adresse-du-site/wp-content/plugins/partenariat-simplon/images/logo.png</code></p>
    </div>
    <div>
      <p>Et si on voulait pouvoir changer le contenu d'un shortcode via Customizer ? Dans ton plugin enregistre un nouveau champ de customizer.</p>
      <code>
<pre>
function partenariat_simplon_infoflash( $wp_customize ) {
  $wp_customize->add_section( 'simplon_shortcode', array(
    'title'       => 'Info Flash',
    'description' => 'Le text à reproduire vie shortcode',
    'priority'        => 130
  ) );
  $wp_customize->add_setting( 'infoflash_shortcode', array(
    'type' => 'option',
    'default' => '',
    'sanitize_callback' => 'wp_kses_post'
  ) );

  $wp_customize->add_control( 'infoflash_shortcode', array(
    'label' => 'Shortcode Personnalisé',
    'type' => 'textarea',
    'section' => 'simplon_shortcode',
  ) );
}
add_action( 'customize_register', 'partenariat_simplon_infoflash' );  
</pre>       
      </code>
    </div>
    <div>
      <p>Vérifie que le champ "Info Flash" est bien présent dans ton Customizer.</p>
    </div>
    <div>
      <p>Remplis le champ Shortcode Personnalisé et clique "Publier". Est-ce bien enregistré ?</p>
    </div>
    <div>
      <p>Ajoute un nouveau shortcode 'simplon-infoflash' (comme dans step 5)</p>
    <code class="astuce">
<pre>
function simplonInfoflashShortcode() {
  return '';
}
add_shortcode( 'simplon-infoflash', 'simplonInfoflashShortcode' );
</pre>
      </code>      
    </div>
    <div>
      <p>Modifie <code>simplonInfoflashShortcode()</code> pour que le contenu du champ
       "Info Flash" soit affiché.</p>
      <code>
<pre>
if ( ! function_exists( 'simplonInfoflashShortcode' ) ) {
  function simplonInfoflashShortcode() {
    return '&lt;p class="simplon-infoflash">' . get_option( 'infoflash_shortcode' ) . '&lt;/p>';
  }
}
add_shortcode( 'simplon-infoflash', 'simplonInfoflashShortcode' );
</pre>
      </code> 
    </div>
    <div>
      <h2>Yay ! Bravo !</h2>
    </div>
  </div>
    <!-- built files will be auto injected -->
  <script type="text/javascript" src="js/chunk-vendors.js"></script><script type="text/javascript" src="js/app.js"></script></body>
</html>
